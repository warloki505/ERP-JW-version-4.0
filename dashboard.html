<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ERP Financeiro JW - Gest√£o Financeira Pessoal v3.1" />
  <title>ERP Financeiro JW - Dashboard v3.1</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- HEADER -->
  <header class="topbar">
    <div class="container topbar__row">
      <h1>üí∞ ERP Financeiro JW v3.1</h1>
      <div class="topbar__actions">
        <span id="userName" class="text-muted" style="font-size: 14px;"></span>
        <button id="btnPerfil" class="btn btn--ghost">‚öôÔ∏è Perfil</button>
        <button id="btnHistorico" class="btn btn--ghost">üìä Hist√≥rico</button>
        <button id="logoutBtn" class="btn btn--ghost">üö™ Sair</button>
      </div>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main class="container">
    
    <!-- SELETOR DE M√äS -->
    <section class="card" style="margin-top: 24px;">
      <div style="display: flex; align-items: center; justify-content: space-between; gap: 16px; flex-wrap: wrap;">
        <div>
          <h2 style="margin-bottom: 4px;">üìÖ M√™s Ativo</h2>
          <p class="text-muted" style="font-size: 14px; margin: 0;">Visualizando dados de <strong id="monthLabel"></strong></p>
        </div>
        <div style="display: flex; gap: 8px;">
          <button id="btnPrevMonth" class="btn btn--ghost">‚Üê Anterior</button>
          <button id="btnCurrentMonth" class="btn btn--primary">M√™s Atual</button>
          <button id="btnNextMonth" class="btn btn--ghost">Pr√≥ximo ‚Üí</button>
        </div>
      </div>
    </section>

    <!-- RESUMO / KPIs COM D√çVIDAS -->
    <section class="card">
      <h2>üíπ RESUMO DO M√äS</h2>
      <div class="kpi-grid">
        
        <div class="kpi kpi--receita">
          <div class="kpi__title">üíµ Renda Total</div>
          <div class="kpi__value" id="kpiRenda">R$ 0,00</div>
        </div>
        
        <div class="kpi kpi--poupanca">
          <div class="kpi__title">üè¶ Poupan√ßa Total</div>
          <div class="kpi__value" id="kpiPoupanca">R$ 0,00</div>
        </div>
        
        <div class="kpi kpi--essenciais">
          <div class="kpi__title">üî¥ Despesas Essenciais</div>
          <div class="kpi__value" id="kpiEssenciais">R$ 0,00</div>
        </div>
        
        <div class="kpi kpi--livres">
          <div class="kpi__title">üü¢ Despesas Livres</div>
          <div class="kpi__value" id="kpiLivres">R$ 0,00</div>
        </div>
        
        <!-- KPI DE D√çVIDAS - DESTAQUE -->
        <div class="kpi kpi--dividas">
          <div class="kpi__title">üí≥ D√çVIDAS TOTAIS</div>
          <div class="kpi__value" id="kpiDividas">R$ 0,00</div>
          <small>‚ö†Ô∏è Priorize quita√ß√£o</small>
        </div>
        
        <div class="kpi kpi--highlight">
          <div class="kpi__title">üíé Saldo a Distribuir</div>
          <div class="kpi__value" id="kpiSaldoDistribuir">R$ 0,00</div>
          <small>valor ainda n√£o comprometido</small>
        </div>
        
      </div>
    </section>

    <!-- LAN√áAMENTOS (4 COLUNAS COM D√çVIDAS) -->
    <section class="grid-4">
      
      <!-- COLUNA 1: RECEITA -->
      <div class="card">
        <h3>üíµ RECEITA</h3>
        <form id="formReceita" class="form">
          <div class="form-group">
            <label for="receitaData">Data</label>
            <input type="date" id="receitaData" name="data" required />
          </div>
          
          <div class="form-group">
            <label for="receitaValor">Valor (R$)</label>
            <input type="number" id="receitaValor" name="valor" step="0.01" min="0.01" placeholder="0,00" required />
          </div>
          
          <div class="form-group">
            <label for="receitaCategoria">Categoria</label>
            <select id="receitaCategoria" name="categoria" required>
              <option value="">Selecione</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="receitaBanco">Banco/Conta</label>
            <select id="receitaBanco" name="banco" required>
              <option value="">Selecione</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="receitaDescricao">Descri√ß√£o (opcional)</label>
            <input type="text" id="receitaDescricao" name="descricao" placeholder="Ex: Sal√°rio de fevereiro" />
          </div>
          
          <button class="btn btn--success" type="submit" style="width: 100%;">
            ‚úì Adicionar Receita
          </button>
        </form>
      </div>

      <!-- COLUNA 2: POUPAN√áA -->
      <div class="card">
        <h3>üè¶ POUPAN√áA</h3>
        <form id="formPoupanca" class="form">
          <div class="form-group">
            <label for="poupancaData">Data</label>
            <input type="date" id="poupancaData" name="data" required />
          </div>
          
          <div class="form-group">
            <label for="poupancaValor">Valor (R$)</label>
            <input type="number" id="poupancaValor" name="valor" step="0.01" min="0.01" placeholder="0,00" required />
          </div>
          
          <div class="form-group">
            <label for="poupancaCategoria">Categoria</label>
            <select id="poupancaCategoria" name="categoria" required>
              <option value="">Selecione</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="poupancaBanco">Banco/Conta</label>
            <select id="poupancaBanco" name="banco" required>
              <option value="">Selecione</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="poupancaDescricao">Descri√ß√£o (opcional)</label>
            <input type="text" id="poupancaDescricao" name="descricao" placeholder="Ex: Reserva de emerg√™ncia" />
          </div>
          
          <button class="btn btn--primary" type="submit" style="width: 100%;">
            ‚úì Adicionar Poupan√ßa
          </button>
        </form>
      </div>

      <!-- COLUNA 3: DESPESAS -->
      <div class="card">
        <h3>üí≥ DESPESAS</h3>
        <form id="formDespesa" class="form">
          <div class="form-group">
            <label for="despesaData">Data</label>
            <input type="date" id="despesaData" name="data" required />
          </div>
          
          <div class="form-group">
            <label for="despesaValor">Valor (R$)</label>
            <input type="number" id="despesaValor" name="valor" step="0.01" min="0.01" placeholder="0,00" required />
          </div>
          
          <div class="form-group">
            <label for="despesaSubtipo">Tipo de Despesa</label>
            <select id="despesaSubtipo" required>
              <option value="">Selecione</option>
              <option value="essencial">üî¥ Despesa Essencial</option>
              <option value="livre">üü¢ Despesa Livre</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="despesaCategoria">Categoria</label>
            <select id="despesaCategoria" required>
              <option value="">Selecione tipo primeiro</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="despesaBanco">Banco/Conta</label>
            <select id="despesaBanco" required>
              <option value="">Selecione</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="despesaDescricao">Descri√ß√£o (opcional)</label>
            <input type="text" id="despesaDescricao" name="descricao" placeholder="Ex: Conta de luz" />
          </div>
          
          <button class="btn btn--danger" type="submit" style="width: 100%;">
            ‚úì Adicionar Despesa
          </button>
        </form>
      </div>

      <!-- COLUNA 4: D√çVIDAS (NOVO) -->
      <div class="card" style="border: 2px solid var(--divida);">
        <h3>‚ö†Ô∏è D√çVIDAS</h3>
        <form id="formDivida" class="form">
          <div class="form-group">
            <label for="dividaData">Data</label>
            <input type="date" id="dividaData" name="data" required />
          </div>
          
          <div class="form-group">
            <label for="dividaValor">Valor (R$)</label>
            <input type="number" id="dividaValor" name="valor" step="0.01" min="0.01" placeholder="0,00" required />
          </div>
          
          <div class="form-group">
            <label for="dividaCategoria">Tipo de D√≠vida</label>
            <select id="dividaCategoria" name="categoria" required>
              <option value="">Selecione</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="dividaBanco">Banco/Origem</label>
            <select id="dividaBanco" name="banco" required>
              <option value="">Selecione</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="dividaDescricao">Descri√ß√£o (opcional)</label>
            <input type="text" id="dividaDescricao" name="descricao" placeholder="Ex: Parcelamento em 12x" />
          </div>
          
          <button class="btn btn--danger" type="submit" style="width: 100%; background: var(--divida);">
            ‚ö†Ô∏è Registrar D√≠vida
          </button>
        </form>
      </div>

    </section>

    <!-- TABELA DE LAN√áAMENTOS -->
    <section class="card">
      <h2>üìã TODOS OS LAN√áAMENTOS</h2>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Tipo</th>
              <th>Data</th>
              <th>Valor</th>
              <th>Categoria</th>
              <th>Banco</th>
              <th>Descri√ß√£o</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="txTbody">
            <tr>
              <td colspan="7" style="text-align: center; padding: 40px;">
                <span class="text-muted">Nenhum lan√ßamento neste m√™s</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- RODAP√â COM A√á√ïES -->
    <section class="footer-actions">
      <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="btn btn--ghost">
        ‚Üë Voltar ao topo
      </button>
      <button onclick="window.print()" class="btn btn--ghost">
        üñ®Ô∏è Imprimir / Exportar PDF
      </button>
      <button onclick="location.href='charts.html'" class="btn btn--ghost">
        üìä Exportar Gr√°ficos
      </button>
      <button id="btnLimparMes" class="btn btn--danger">
        üóëÔ∏è Limpar todos os dados do m√™s
      </button>
    </section>

  </main>

  <!-- MODAL DE EDI√á√ÉO -->
  <div id="modalEdit" class="modal-overlay hidden" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>‚úèÔ∏è Editar Lan√ßamento</h3>
        <button onclick="closeEditModal()" class="btn btn--ghost btn-mini">‚úï</button>
      </div>
      <div class="modal-body">
        <form id="formEdit" class="form">
          <input type="hidden" id="editId" />
          <input type="hidden" id="editTipo" />
          
          <div class="form-group">
            <label for="editData">Data</label>
            <input type="date" id="editData" required />
          </div>
          
          <div class="form-group">
            <label for="editValor">Valor (R$)</label>
            <input type="number" id="editValor" step="0.01" min="0.01" required />
          </div>
          
          <div class="form-group">
            <label for="editCategoria">Categoria</label>
            <select id="editCategoria" required></select>
          </div>
          
          <div class="form-group">
            <label for="editBanco">Banco</label>
            <select id="editBanco" required></select>
          </div>
          
          <div class="form-group">
            <label for="editDescricao">Descri√ß√£o</label>
            <input type="text" id="editDescricao" />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button onclick="closeEditModal()" class="btn btn--ghost">Cancelar</button>
        <button onclick="saveEdit()" class="btn btn--primary">üíæ Salvar altera√ß√µes</button>
      </div>
    </div>
  </div>


  <!-- MODAL: FIXAR LAN√áAMENTO (RECORR√äNCIA) -->
  <div id="modalFixar" class="modal-overlay hidden" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>üìå Fixar lan√ßamento</h3>
        <button onclick="closeFixarModal()" class="btn btn--ghost btn-mini">‚úï</button>
      </div>
      <div class="modal-body">
        <p class="text-muted" style="margin-top: 0;">Este lan√ßamento ser√° repetido automaticamente nos meses escolhidos.</p>

        <div class="status status--info" style="margin-bottom: 12px;">
          <strong id="fixResumo">‚Äî</strong>
        </div>

        <form id="formFixar" class="form" onsubmit="event.preventDefault(); saveFixar();">
          <div class="form-group">
            <label for="fixInicio">In√≠cio (m√™s)</label>
            <input type="month" id="fixInicio" required />
          </div>

          <div class="form-group">
            <label for="fixFim">Fim (m√™s)</label>
            <input type="month" id="fixFim" />
            <div style="margin-top: 8px;">
              <label style="display:flex; align-items:center; gap:8px; font-size: 13px;">
                <input type="checkbox" id="fixSemFim" />
                Sem fim
              </label>
            </div>
          </div>

          <div class="form-group">
            <label style="display:flex; align-items:center; gap:8px; font-size: 13px;">
              <input type="checkbox" id="fixAplicarAtual" checked />
              Aplicar tamb√©m no m√™s atual
            </label>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button onclick="closeFixarModal()" class="btn btn--ghost">Cancelar</button>
        <button onclick="saveFixar()" class="btn btn--primary">üìå Fixar</button>
      </div>
    </div>
  </div>


  <!-- SCRIPTS -->
  <script src="js/constantes.js"></script>
  <script src="js/config.js"></script>
  <script src="js/dashboard.js"></script>
</body>
</html>
